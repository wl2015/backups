$(document).ready(function(){

  $("#input-body").find("input[name='password']").blur(valiPassword);
  
  $('#loginSubmit').click(function(){
    //alert("进入登录判断");
    var type = $('input:radio[name="type"]:checked').val();
    var account = $("#input-body").find("input[name='account']").val();
    var _password = $("#input-body").find("input[name='password']").val();
    if (type == "手机") {
      //alert(type);
      $("#input-body").find("input[name='account']").blur(valiPhone);

      if (valiPhone() && valiPassword()) {
        //alert("开始提交手机ajax");
        $.ajax({
          url : WEBROOT + "/admin/adminLogin.do",
          type: "post",
          dataType: "json",
          data:{
            type:type,
            account:account,
            password:_password,
          },
          success: function(res) {
            if (res.code == "SUCCESS") {
              alert("登录成功！");
              window.location = WEBROOT + '/admin/adminIndex.do';
            }else if (res.code == "FAILE") {
              alert("手机登录失败！查无此人或检查登录方式");
              window.location = WEBROOT + '/admin/login.do';
              return false;
            }
          },
          error:function(){
            alert("系统繁忙，请稍后操作");
          }
        });
        
      }
      else {
        alert("账号或密码格式不正确！");
      }
    } 
    else if(type == "账号"){
      //alert(type);
      $("#input-body").find("input[name='account']").blur(valiAccount);
      if (valiAccount() && valiPassword()) {
        //alert("开始提交账号ajax");
        $.ajax({
          url : WEBROOT + "/admin/adminLogin.do",
          type: "post",
          dataType: "json",
          data:{
            type:type,
            account:account,
            password:_password,
          },
          success: function(res) {
            if (res.code == "SUCCESS") {
              alert("登录成功！");
              window.location = WEBROOT + '/admin/adminIndex.do';
            }else if (res.code == "FAILE") {
              alert("账号登录失败！查无此人或检查登录方式");
              window.location = WEBROOT + '/admin/login.do';
              return false;
            }
          },
          error:function(){
            alert("系统繁忙，请稍后操作");
          }
        });        
      }
      else {
        alert("账号或密码格式不正确！");
      }
    }
  });


});

/**
 * 验证手机号是否符合格式
 * @returns {Boolean}
 */
function valiPhone() {
  var account = $("#input-body").find("input[name='account']").val();
  if (!CHECK.isPhoneNumber(account)) {
    $("#input-body").find("#AcountMsg").html("手机号格式不正确");
    alert("手机号格式不正确");
    return false;
  } else {
    $("#input-body").find("#AcountMsg").html("通过");
    return true;  
  }
}

/**
 * 验证账号是否符合格式，是否非法格式
 * @returns {Boolean}
 */
function valiAccount() {
  var account = $("#input-body").find("input[name='account']").val();
  if (/[@#\$%\^&\*]+/g.test(account)) {
    $("#input-body").find("#AcountMsg").html("含有非法字符");
    alert("含有非法字符");
    return false;
  } else {
    $("#input-body").find("#AcountMsg").html("通过");
    return true;  
  }
}

/**
 * 验证密码是否符合规定格式
 * @returns {Boolean}
 */
function valiPassword() {
  var _password = $("#input-body").find("input[name='password']").val();
  if (!CHECK.isPassword(_password)) {
   
    $("#input-body").find("#PassMsg").html("密码长度应在6~12位");
    return false;
  } else {
    $("#input-body").find("#PassMsg").html("通过");
    return true;
  }
}

/**
 * 提交手机登录表单
 */
function checkAndSubmitByPhone() {
  if (valiPhone() && valiPassword()) {

    $("#login").find("form").submit();	
    
  }
  else {
    alert("手机登录");
    alert("账号或密码格式不正确！");
  }
}

/**
 * 提交账号登录表单
 */
function checkAndSubmitByAccount() {
  if (valiAccount() && valiPassword()) {

    $("#login").find("form").submit();  
  }
  else {
    alert("账号登录");
    alert("账号或密码格式不正确！");
  }
}
